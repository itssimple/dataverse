var I=Object.defineProperty;var S=(l,s,d)=>s in l?I(l,s,{enumerable:!0,configurable:!0,writable:!0,value:d}):l[s]=d;var u=(l,s,d)=>(S(l,typeof s!="symbol"?s+"":s,d),d);import{o as c,_ as b,D as w,c as D,B as v}from"./vendor-0da8b43b.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))h(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const e of r.addedNodes)e.tagName==="LINK"&&e.rel==="modulepreload"&&h(e)}).observe(document,{childList:!0,subtree:!0});function d(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function h(n){if(n.ep)return;n.ep=!0;const r=d(n);fetch(n.href,r)}})();function g(l,...s){console.log(`[${l}]`,JSON.stringify([...s]))}function j(){return c(b,{children:["Main page -"," ",c("a",{href:"https://o2g.itssimple.se/authenticate/everversedata?state=dataverse-"+new Date().getTime(),children:"Log in"})]})}function B(){return c(b,{children:[c("header",{className:"header tooltip",children:"Dataverse"}),c("div",{class:"app",children:c(w,{history:D(),children:[c(b,{path:"/",children:c(j,{})}),c("div",{path:"/authenticated",children:"Authenticated"})]})}),c("footer",{className:"fui body fiction",children:"Â© 2023 NoLifeKing85#2914"})]})}class P{constructor(){u(this,"DBInstance");u(this,"initializeDatabase");u(this,"setItem");u(this,"getItem");u(this,"removeItem");u(this,"setStorageItem");u(this,"getStorageItem");u(this,"getStorageItems");u(this,"removeStorageItem");this.DBInstance=null,this.initializeDatabase=async function(){return new Promise((e,t)=>{let o=window.indexedDB.open("destiny2-dataverse",2);o.onupgradeneeded=function(a){const f=o.result;g("DB","Old",a.oldVersion,"New",a.newVersion),a.oldVersion<1&&(g("DB","Creating first version of database, since it never existed on this installation."),f.createObjectStore("storage",{autoIncrement:!1,keyPath:"key"}).createIndex("by_key","key")),a.oldVersion<2&&(g("DB","Creating object store for player/character activity"),f.createObjectStore("playerActivity",{autoIncrement:!1,keyPath:"key"}).createIndex("by_key","key"),f.createObjectStore("activityDetails",{autoIncrement:!1,keyPath:"key"}).createIndex("by_key","key"))},o.onsuccess=function(a){g("DB","Loaded database"),r.DBInstance=a.target.result,e()},o.onerror=function(a){g("DB","Failed to load database"),t(a)}})};async function s(e,t,o){return new Promise((a,f)=>{const i=r.DBInstance.transaction(e,"readwrite").objectStore(e).put({key:t,value:o});i.onsuccess=function(){a()},i.onerror=function(m){f(m)}})}async function d(e,t=null){return new Promise((o,a)=>{const y=r.DBInstance.transaction(e,"readonly").objectStore(e).getAll();y.onsuccess=function(){const i=y.result;o(t?i.filter(t):i)},y.onerror=function(i){a(i)}})}async function h(e,t,o=null){return new Promise((a,f)=>{const i=r.DBInstance.transaction(e,"readonly").objectStore(e).get(t);i.onsuccess=function(m){m.target.result?a(m.target.result.value):a(o)},i.onerror=function(m){f(m)}})}async function n(e,t){return new Promise((o,a)=>{const y=r.DBInstance.transaction(e,"readwrite").objectStore(e).delete(t);y.onsuccess=function(){o()},y.onerror=function(i){a(i)}})}this.setItem=async function(e,t){return await s("storage",e,t)},this.getItem=async function(e,t=null){return await h("storage",e,t)},this.removeItem=async function(e){return await n("storage",e)},this.setStorageItem=async function(e,t,o){return await s(e,t,o)},this.getStorageItem=async function(e,t,o=null){return await h(e,t,o)},this.getStorageItems=async function(e,t=null){return await d(e,t)},this.removeStorageItem=async function(e,t){return await n(e,t)};var r=this;return this}}window.db=new P;g("MAIN","Starting app...");window.db.initializeDatabase();v(c(B,{}),document.getElementById("app"));
//# sourceMappingURL=index-e950790e.js.map
